# 📱 短信验证码转发器

一个简单实用的工具，让你的安卓手机短信验证码实时同步到Mac电脑上，解决跨平台验证码输入的痛点。

## ✨ 功能特点

- 🚀 **实时转发**：收到短信立即推送到Mac
- 🔒 **本地网络**：数据只在局域网内传输，安全可靠
- 💡 **智能识别**：自动高亮显示验证码
- 🎨 **美观界面**：现代化的UI设计
- ⚡ **轻量高效**：资源占用少，响应迅速

## 📋 系统要求

### Mac端
- macOS 10.14 或更高版本
- Python 3.7+
- 与安卓设备处于同一局域网

### 安卓端
- Android 6.0 (API 24) 或更高版本
- 需要授予短信读取权限
- 与Mac处于同一局域网

## 🚀 快速开始

### 第一步：启动Mac端服务器

1. 安装依赖：
```bash
cd mac-app
pip3 install -r requirements.txt
```

2. 启动服务器：
```bash
python3 server.py
```

3. 记下显示的IP地址（例如：`192.168.1.100`）

服务器启动后，你会看到：
```
==================================================
📱 短信验证码接收服务器
==================================================
本机IP地址: 192.168.1.100
访问地址: http://192.168.1.100:5000
本地访问: http://localhost:5000
==================================================
```

4. 在浏览器中打开 `http://localhost:5000` 查看Web界面

### 第二步：安装并配置安卓应用

1. 使用Android Studio打开 `android-app` 目录

2. 构建并安装到你的安卓设备：
```bash
./gradlew installDebug
```

或者直接在Android Studio中点击运行按钮

3. 打开应用后：
   - 授予短信读取权限
   - 授予通知权限
   - 输入Mac服务器的IP地址（例如：`192.168.1.100`）
   - 端口号保持默认 `5000`
   - 点击"测试连接"确认连接正常
   - 开启"启用短信转发"开关

### 第三步：开始使用

现在，当你的安卓手机收到短信时：
1. 短信会自动被捕获
2. 通过局域网发送到Mac
3. 在Mac浏览器中实时显示
4. 验证码会被自动高亮

## 📱 Android应用截图说明

### 主界面功能
- **服务器配置**：输入Mac的IP地址和端口
- **测试连接**：验证网络连接是否正常
- **服务控制**：一键开启/关闭转发服务
- **运行状态**：显示最后转发的短信信息

## 💻 Mac端界面说明

### Web界面功能
- **实时显示**：收到的短信实时显示
- **验证码高亮**：4-8位数字自动高亮显示
- **消息历史**：保留最近50条消息
- **一键清空**：快速清除所有消息
- **自动刷新**：每2秒自动更新

## 🔧 技术架构

### Mac端
- **框架**：Flask (Python Web框架)
- **功能**：
  - HTTP API服务器接收短信数据
  - WebSocket实时推送（可选）
  - 现代化Web UI界面
  - 本地IP地址自动检测

### 安卓端
- **语言**：Kotlin
- **架构**：
  - BroadcastReceiver：监听系统短信广播
  - ForegroundService：保持服务持续运行
  - OkHttp：网络请求库
  - Material Design：现代化UI设计

## 📡 API接口文档

### 接收短信
```
POST /api/sms
Content-Type: application/json

{
  "sender": "10086",
  "content": "您的验证码是123456",
  "timestamp": "1697000000000"
}
```

### 获取消息列表
```
GET /api/messages

Response:
{
  "status": "success",
  "messages": [...]
}
```

### 清空消息
```
POST /api/clear

Response:
{
  "status": "success",
  "message": "消息已清空"
}
```

## 🔐 安全说明

- ✅ 数据仅在本地局域网传输，不经过互联网
- ✅ 不存储任何短信内容到磁盘
- ✅ 不上传任何数据到云端
- ✅ 建议仅在可信任的WiFi网络下使用
- ⚠️ Mac服务器默认不设密码，请勿暴露到公网

## 🛠️ 故障排查

### 安卓应用无法连接到Mac

1. **检查网络**：
   - 确认手机和Mac在同一WiFi
   - 尝试ping Mac的IP地址

2. **检查防火墙**：
   - Mac防火墙可能阻止了5000端口
   - 系统偏好设置 → 安全性与隐私 → 防火墙选项 → 允许Python

3. **检查IP地址**：
   - 确认输入的IP地址正确
   - Mac的IP可能会变化，重启服务器查看最新IP

### 短信没有转发

1. **检查权限**：
   - 确认已授予短信读取权限
   - 某些手机需要在设置中允许后台运行

2. **检查服务状态**：
   - 确认应用中的服务开关已开启
   - 查看通知栏是否有"短信转发服务运行中"

3. **查看日志**：
   - 使用 `adb logcat | grep SmsReceiver` 查看日志

### Mac服务器启动失败

1. **端口被占用**：
```bash
# 查找占用5000端口的进程
lsof -i :5000
# 杀死进程
kill -9 <PID>
```

2. **Python依赖缺失**：
```bash
pip3 install --upgrade -r requirements.txt
```

## 🎯 使用场景

- 📝 网站登录需要短信验证码
- 💳 银行转账验证
- 🔑 双因素认证
- 📱 各类APP注册/登录

## 🌟 优化建议

### 提升性能
- Mac服务器可以设置开机自启动
- 安卓应用可以加入电池优化白名单

### 增强安全
- 可以为API添加Token认证
- 可以使用HTTPS加密传输
- 可以限制特定发件人才转发

## 📝 TODO（未来计划）

- [ ] 添加消息筛选规则（只转发特定号码）
- [ ] 支持多设备同时连接
- [ ] 添加历史记录持久化
- [ ] iOS端支持（利用快捷指令）
- [ ] 添加桌面通知
- [ ] 支持自定义验证码识别规则
- [ ] 添加Web界面密码保护

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📄 许可证

MIT License

## ⚠️ 免责声明

本项目仅供学习和个人使用。请遵守当地法律法规，不要用于非法用途。短信内容可能包含敏感信息，请注意保护隐私安全。

## 📧 联系方式

如有问题或建议，欢迎提Issue讨论。

---

**享受便捷的验证码同步体验吧！** 🎉

